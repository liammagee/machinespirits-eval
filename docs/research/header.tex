\usepackage{unicode-math}
\setmathfont{latinmodern-math.otf}
\usepackage{etoolbox}
\usepackage{newunicodechar}

% Map Unicode math symbols to LaTeX math mode so they render
% correctly even when xelatex probes the text font
\newunicodechar{‚âà}{$\approx$}
\newunicodechar{‚â•}{$\geq$}
\newunicodechar{ùúí}{$\chi$}

% Suppress missing-character warnings from xelatex font probing
% (unicode-math internally uses Unicode codepoints that trigger
% text-font lookups in table cells before math font resolves them)
\tracinglostchars=0

% Shrink monospace font so code spans fit in table columns
\let\oldtexttt\texttt
\DeclareRobustCommand{\texttt}[1]{{\ttfamily\small #1}}

% Allow line breaks at underscores so variable names like
% recognition_moment can wrap instead of overflowing columns
\let\oldtextunderscore\_
\renewcommand{\_}{\oldtextunderscore\hspace{0pt}}

% Shrink table text and tighten column padding to prevent overflow
% (5pt balances Table 21b fit vs Table 41 column merging at 4pt)
\AtBeginEnvironment{longtable}{\small\setlength{\tabcolsep}{5pt}}

% Shrink code blocks to prevent right-margin overflow
\AtBeginDocument{%
  \author{Liam Magee\footnote{This sentence is the only one actually authored by Liam Magee in this paper.}\\[0.3em]Education Policy, Organization and Leadership\\University of Illinois Urbana-Champaign}%
  \apptocmd{\Shaded}{\footnotesize}{}{}%
}
